!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.TextAreaSuggestion=e()}}(function(){return function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){var n=t[o][1][e];return r(n?n:e)},h,h.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function s(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!s(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,s,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],a(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,s=new Array(i-1),u=1;i>u;u++)s[u-1]=arguments[u];n.apply(this,s)}else if(o(n)){for(i=arguments.length,s=new Array(i-1),u=1;i>u;u++)s[u-1]=arguments[u];for(l=n.slice(),i=l.length,u=0;i>u;u++)l[u].apply(this,s)}return!0},i.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var n;n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,i,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(a=s;a-->0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],2:[function(e,t,n){!function(){function e(e,t){var r=document.createElement("div");r.id="input-textarea-caret-position-mirror-div",document.body.appendChild(r);var s=r.style,o=window.getComputedStyle?getComputedStyle(e):e.currentStyle;s.whiteSpace="pre-wrap","INPUT"!==e.nodeName&&(s.wordWrap="break-word"),s.position="absolute",s.visibility="hidden",n.forEach(function(e){s[e]=o[e]}),i?e.scrollHeight>parseInt(o.height)&&(s.overflowY="scroll"):s.overflow="hidden",r.textContent=e.value.substring(0,t),"INPUT"===e.nodeName&&(r.textContent=r.textContent.replace(/\s/g,"Â "));var a=document.createElement("span");a.textContent=e.value.substring(t)||".",r.appendChild(a);var u={top:a.offsetTop+parseInt(o.borderTopWidth),left:a.offsetLeft+parseInt(o.borderLeftWidth)};return document.body.removeChild(r),u}var n=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],i=null!=window.mozInnerScreenX;"undefined"!=typeof t&&"undefined"!=typeof t.exports?t.exports=e:window.getCaretCoordinates=e}()},{}],3:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=e("./textarea"),o=e("./suggestion"),a=function(){function e(t,n){var r=this;if(i(this,e),!t)throw new Error("Invalid argument");"string"==typeof t&&(t=document.querySelector(t)),this.textArea=new s(t),this.suggestion=new o(n),this.text="",this.textArea.on("input",function(e){if(r.suggestion.isShown?r.textArea.isDeleted&&0!==r.text.length?r.text=r.text.substring(0,r.text.length-1):r.text+=e:r.text=e,r.suggestion.setMatcher(r.text),0!==r.text.length&&0!==r.suggestion.matched.length){var t=r.textArea.popupPosition;r.suggestion.prepareItems(),r.suggestion.show(t.top,t.left)}else r.suggestion.hide()}),this.textArea.on("enter",function(e){r.suggestion.isSelected&&(e.preventDefault(),r.textArea.insert(r.text,r.suggestion.selected)),r.suggestion.hide()}),this.textArea.on("up",function(e){r.suggestion.isShown&&(e.preventDefault(),r.suggestion.selectedIndex>0&&r.suggestion.selectedIndex--,r.suggestion.highlight())}),this.textArea.on("down",function(e){r.suggestion.isShown&&(e.preventDefault(),r.suggestion.selectedIndex<r.suggestion.matched.length-1&&r.suggestion.selectedIndex++,r.suggestion.highlight())}),this.suggestion.on("click",function(e){r.textArea.insert(r.text,e.target.textContent),r.suggestion.hide()})}return r(e,[{key:"setSuggestions",value:function(e){this.suggestion.setSuggestions(e)}}]),e}();void 0!==t&&void 0!==t.exports?t.exports=a:window.TextAreaSuggestion=a},{"./suggestion":4,"./textarea":5}],4:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(e,t,n){for(var i=!0;i;){var r=e,s=t,o=n;a=l=u=void 0,i=!1;var a=Object.getOwnPropertyDescriptor(r,s);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(o)}var l=Object.getPrototypeOf(r);if(null===l)return void 0;e=l,t=s,n=o,i=!0}},a=e("events").EventEmitter,u=function(e){function t(e){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.selectedIndex=-1,this.suggestions=[],this.container=null,this.list=[],this.matcher="",this.setSuggestions(e),this.prepareContainer()}return r(t,e),s(t,[{key:"prepareContainer",value:function(){null==this.container&&(this.container=document.createElement("ul"),this.container.className="suggestion",this.container.style.position="absolute",this.container.style.display="none",this.container.style.listStyle="none",document.body.appendChild(this.container))}},{key:"prepareItems",value:function(){this.list.length=0,this.container.innerHTML="";var e=!0,t=!1,n=void 0;try{for(var i,r=this.matched[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var s=i.value,o=document.createElement("li");o.className="suggestion__item",o.textContent=s,o.addEventListener("click",this.onClick.bind(this)),this.list.push(o),this.container.appendChild(o)}}catch(a){t=!0,n=a}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw n}}}},{key:"setMatcher",value:function(e){this.matcher=e}},{key:"setSuggestions",value:function(){var e=void 0===arguments[0]?[]:arguments[0];Array.isArray(e)||(e=[e]),this.suggestions.length=0;var t=!0,n=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value;"string"==typeof o&&this.suggestions.push(o)}}catch(a){n=!0,i=a}finally{try{!t&&s["return"]&&s["return"]()}finally{if(n)throw i}}}},{key:"show",value:function(e,t){this.container.style.top=e+"px",this.container.style.left=t+"px",this.container.style.display="block",this.container.classList.add("is-shown")}},{key:"hide",value:function(){this.container.style.display="none",this.selectedIndex=-1,this.container.classList.remove("is-shown");var e=!0,t=!1,n=void 0;try{for(var i,r=this.list[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var s=i.value;s.classList.remove("is-selected")}}catch(o){t=!0,n=o}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw n}}}},{key:"highlight",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,r=this.list[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var s=i.value;s.classList.remove("is-selected")}}catch(o){t=!0,n=o}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw n}}this.list[this.selectedIndex].classList.add("is-selected")}},{key:"onClick",value:function(e){this.emit("click",e)}},{key:"isSelected",get:function(){return this.isShown&&-1!==this.selectedIndex}},{key:"isShown",get:function(){return this.container.classList.contains("is-shown")}},{key:"matched",get:function(){var e=this;return this.suggestions.filter(function(t){return-1!==t.indexOf(e.matcher)})}},{key:"selected",get:function(){return this.matched[this.selectedIndex]}}]),t}(a);n["default"]=u,t.exports=n["default"]},{events:1}],5:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(e,t,n){for(var i=!0;i;){var r=e,s=t,o=n;a=l=u=void 0,i=!1;var a=Object.getOwnPropertyDescriptor(r,s);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(o)}var l=Object.getPrototypeOf(r);if(null===l)return void 0;e=l,t=s,n=o,i=!0}},a=e("events").EventEmitter,u=e("textarea-caret-position/index.js"),l=8,h=13,c=38,f=40,d=function(e){function t(e){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.textarea=e,this.style=getComputedStyle(e),this.selectionStart=0,this.selectionEnd=0,this.input="",this.isDeleted=!1,e.addEventListener("input",this.onInput.bind(this)),e.addEventListener("keydown",this.onKeyDown.bind(this))}return r(t,e),s(t,[{key:"insert",value:function(e,t){var n=this.selectionEnd+t.length;this.textarea.setSelectionRange(this.selectionEnd-e.length,this.selectionEnd),this.textarea.setRangeText(t),this.textarea.setSelectionRange(n,n)}},{key:"onInput",value:function(e){this.selectionStart=e.target.selectionStart,this.selectionEnd=e.target.selectionEnd,this.input=this.isDeleted?"":this.textarea.value.substring(this.selectionEnd-1,this.selectionEnd),this.emit("input",this.input)}},{key:"onKeyDown",value:function(e){switch(e.keyCode){case l:this.emit("delete"),this.isDeleted=!0;break;case h:this.emit("enter",e);break;case c:this.emit("up",e);break;case f:this.emit("down",e);break;default:this.isDeleted=!1}}},{key:"fontSize",get:function(){return Number(this.style["font-size"].replace(/(px)/,""))}},{key:"position",get:function(){return{top:this.textarea.offsetTop,left:this.textarea.offsetLeft}}},{key:"popupPosition",get:function(){var e=this.position,t=u(this.textarea,this.textarea.selectionEnd);return{top:e.top+t.top+this.fontSize,left:e.left+t.left}}}]),t}(a);n["default"]=d,t.exports=n["default"]},{events:1,"textarea-caret-position/index.js":2}]},{},[3])(3)});